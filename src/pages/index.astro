---
import { getCollection } from 'astro:content';
import { FaEnvelope, FaGithub, FaLinkedin } from 'react-icons/fa6';
import Footer from '@/components/Footer.astro';
import MotionCard from '@/components/MotionCard';
import MotionReveal from '@/components/MotionReveal';
import SectionHeading from '@/components/SectionHeading.astro';
import SiteHeader from '@/components/SiteHeader.astro';
import TypedText from '@/components/TypedText';
import { aboutParagraphs, experiences, projects, skillGroups } from '@/data/content';
import { personSchema, siteConfig } from '@/data/site';
import { formatDate } from '@/utils/format';
import BaseLayout from '@/layouts/BaseLayout.astro';

const featuredPosts = (await getCollection('blog', (entry) => !entry.data.draft && entry.data.featured))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<BaseLayout
  title="Christian D. Glissov | Senior AI Specialist"
  description="Portfolio, experience, projects, and writing by Christian D. Glissov."
  path="/"
  structuredData={personSchema}
>
  <SiteHeader />
  <main id="content" class="pb-16 pt-10 md:pt-14">
    <section class="section-shell mb-10">
      <p class="mono mb-3 text-xs uppercase tracking-[0.2em] text-accent">Portfolio</p>
      <h1 class="text-3xl font-semibold tracking-tight text-slate-100 md:text-5xl">{siteConfig.name}</h1>
      <p class="mt-3 text-lg text-slate-200 md:text-xl">
        <TypedText client:load className="font-medium" phrases={siteConfig.heroPhrases} />
      </p>
      <p class="mt-4 max-w-2xl text-sm text-muted md:text-base">{siteConfig.shortBio}</p>
      <p class="mt-3 max-w-2xl text-sm text-muted md:text-base">
        I build robust AI products for real-world workflows, from research framing to production delivery.
      </p>
      <div class="mt-6 flex flex-wrap items-center gap-3">
        <a class="action-link" href={siteConfig.linkedinUrl} target="_blank" rel="noreferrer">
          <FaLinkedin aria-hidden="true" />
          LinkedIn
        </a>
        <a class="action-link" href={siteConfig.githubUrl} target="_blank" rel="noreferrer">
          <FaGithub aria-hidden="true" />
          GitHub
        </a>
        <a class="action-link" href="#contact">
          <FaEnvelope aria-hidden="true" />
          Email
        </a>
      </div>
    </section>

    <MotionReveal client:visible className="mb-10">
      <section id="about" class="section-shell">
        <SectionHeading
          kicker="About"
          title="Production-minded AI engineering"
          subtitle="I focus on systems that stay trustworthy and useful over time."
        />
        <div class="space-y-4 text-sm leading-7 text-slate-300 md:text-base">
          {aboutParagraphs.map((paragraph) => <p>{paragraph}</p>)}
        </div>
      </section>
    </MotionReveal>

    <MotionReveal client:visible className="mb-10" delay={0.05}>
      <section id="skills" class="section-shell">
        <SectionHeading kicker="Skills" title="Core capabilities" />
        <div class="grid gap-4 md:grid-cols-3">
          {
            skillGroups.map((group) => (
              <article class="rounded-xl border border-border bg-white/5 p-4">
                <h3 class="text-base font-semibold text-slate-100">{group.title}</h3>
                <ul class="mt-3 space-y-2 text-sm text-muted">
                  {group.items.map((item) => <li>- {item}</li>)}
                </ul>
              </article>
            ))
          }
        </div>
      </section>
    </MotionReveal>

    <MotionReveal client:visible className="mb-10" delay={0.1}>
      <section id="experience" class="section-shell">
        <SectionHeading kicker="Experience" title="Recent work" />
        <div class="space-y-4">
          {
            experiences.map((experience) => (
              <article class="rounded-xl border border-border bg-white/5 p-5">
                <div class="flex flex-wrap items-center justify-between gap-2">
                  <h3 class="text-base font-semibold text-slate-100">{experience.role}</h3>
                  <p class="mono text-xs uppercase tracking-wide text-muted">{experience.period}</p>
                </div>
                <p class="mt-1 text-sm text-accent">{experience.company}</p>
                <ul class="mt-4 space-y-2 text-sm text-muted">
                  {experience.bullets.map((bullet) => <li>- {bullet}</li>)}
                </ul>
              </article>
            ))
          }
        </div>
      </section>
    </MotionReveal>

    <MotionReveal client:visible className="mb-10" delay={0.12}>
      <section id="projects" class="section-shell">
        <SectionHeading kicker="Projects" title="Selected implementations" />
        <div class="grid gap-4 md:grid-cols-2">
          {
            projects.map((project) => (
              <MotionCard client:visible className="h-full">
                <article class="flex h-full flex-col rounded-xl border border-border bg-white/5 p-5">
                  <h3 class="text-base font-semibold text-slate-100">{project.name}</h3>
                  <p class="mt-2 text-sm text-muted">{project.description}</p>
                  <ul class="mt-4 flex flex-wrap gap-2">
                    {project.stack.map((tech) => <li class="tag">{tech}</li>)}
                  </ul>
                  <a class="mt-5 text-sm text-accent underline-offset-4 hover:underline" href={project.href} target="_blank" rel="noreferrer">
                    View details
                  </a>
                </article>
              </MotionCard>
            ))
          }
        </div>
      </section>
    </MotionReveal>

    <MotionReveal client:visible className="mb-10" delay={0.15}>
      <section class="section-shell">
        <SectionHeading
          kicker="Featured Writing"
          title="Recent notes from the blog"
          subtitle="Technical write-ups on evaluation, modelling, and AI delivery practices."
        />
        <div class="grid gap-4 md:grid-cols-3">
          {
            featuredPosts.map((post) => (
              <article class="rounded-xl border border-border bg-white/5 p-4">
                <p class="mono text-xs uppercase tracking-wide text-muted">{formatDate(post.data.pubDate)}</p>
                <h3 class="mt-2 text-base font-semibold text-slate-100">
                  <a class="hover:text-accent" href={`/blog/${post.slug}/`}>
                    {post.data.title}
                  </a>
                </h3>
                <p class="mt-2 text-sm text-muted">{post.data.description}</p>
                <ul class="mt-3 flex flex-wrap gap-2">
                  {post.data.tags.map((tag) => <li class="tag">{tag}</li>)}
                </ul>
              </article>
            ))
          }
        </div>
        <a class="mt-6 inline-block text-sm text-accent underline-offset-4 hover:underline" href="/blog/">
          Browse all posts
        </a>
      </section>
    </MotionReveal>

    <MotionReveal client:visible delay={0.18}>
      <section id="contact" class="section-shell">
        <SectionHeading
          kicker="Contact"
          title="Letâ€™s discuss your AI roadmap"
          subtitle="Share the current problem, constraints, and timeline."
        />
        <form action={siteConfig.formspreeUrl} class="grid gap-4" method="POST">
          <label class="grid gap-2 text-sm">
            <span class="text-muted">Name</span>
            <input
              class="rounded-lg border border-border bg-white/5 px-3 py-2 text-sm text-slate-100 outline-none ring-accent transition focus:ring-2"
              type="text"
              name="name"
              required
            />
          </label>
          <label class="grid gap-2 text-sm">
            <span class="text-muted">Email</span>
            <input
              class="rounded-lg border border-border bg-white/5 px-3 py-2 text-sm text-slate-100 outline-none ring-accent transition focus:ring-2"
              type="email"
              name="email"
              required
            />
          </label>
          <label class="grid gap-2 text-sm">
            <span class="text-muted">Message</span>
            <textarea
              class="min-h-32 rounded-lg border border-border bg-white/5 px-3 py-2 text-sm text-slate-100 outline-none ring-accent transition focus:ring-2"
              name="message"
              required
            ></textarea>
          </label>
          <button
            type="submit"
            class="w-fit rounded-lg border border-border bg-white/10 px-4 py-2 text-sm font-medium text-slate-100 transition hover:border-accent hover:text-accent focus-visible:outline focus-visible:outline-2 focus-visible:outline-accent"
          >
            Send message
          </button>
        </form>
      </section>
    </MotionReveal>
  </main>
  <Footer />
</BaseLayout>

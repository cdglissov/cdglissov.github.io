---
import type { CollectionEntry } from 'astro:content';
import type { HTMLAttributes } from 'astro/types';
import { formatDate } from '@/utils/format';

type Props = {
  post: CollectionEntry<'blog'>;
  showTags?: boolean;
} & HTMLAttributes<'a'>;

const { post, showTags = true, href, class: className, ...anchorProps } = Astro.props as Props;

const anchorClass = [
  'group block rounded-xl focus-visible:outline focus-visible:outline-2 focus-visible:outline-accent',
  className
]
  .filter(Boolean)
  .join(' ');
---

<a class={anchorClass} href={href ?? `/blog/${post.slug}/`} {...anchorProps}>
  <article class="blog-post-card">
    <p class="mono text-xs uppercase tracking-wide text-muted">
      {formatDate(post.data.pubDate)}
    </p>
    <h2 class="blog-post-card-title">{post.data.title}</h2>
    <p class="mt-2 text-sm text-muted">{post.data.description}</p>
    {
      showTags && post.data.tags.length > 0 && (
        <ul class="mt-3 flex flex-wrap gap-2">
          {post.data.tags.map((tag) => (
            <li class="tag">{tag}</li>
          ))}
        </ul>
      )
    }
  </article>
</a>
